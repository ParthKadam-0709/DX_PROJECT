{% extends 'DX_APP/base.html' %}

{% block hero %}
<section class="hero-section d-flex align-items-center justify-content-center text-center py-5 mb-4 premium-bg animated-bg" style="min-height: 40vh;">
    <div class="container">
        <h1 class="display-4 fw-bold text-gradient mb-3">AI Crop Recommendation System</h1>
        <p class="lead text-dark-50 mb-0">Empowering farmers and agri-enthusiasts with smart, data-driven crop suggestions for better yield and sustainability.</p>
    </div>
</section>
{% endblock %}

{% block content %}
<div class="row justify-content-center align-items-center min-vh-60">
    <div class="col-lg-6 col-md-8">
        <div class="card shadow-lg border-0 premium-card glass-card">
            <div class="card-body p-5">
                <h2 class="card-title text-center mb-4 fw-bold text-gradient">Get Your Crop Recommendation</h2>
                <div class="language-select-section mb-4 p-3 rounded shadow-sm glass-card">
                    <h5 class="fw-bold text-center mb-3">
                        {% if lang == 'en' %}"Choose the language for your crops weekly planner"{% elif lang == 'hi' %}"अपनी फसल की साप्ताहिक योजना के लिए भाषा चुनें"{% elif lang == 'mr' %}"आपल्या पिकाच्या साप्ताहिक नियोजनेसाठी भाषा निवडा"{% endif %}
                    </h5>
                    <div class="text-center">
                        <form method="get" style="display:inline;">
                            <input type="hidden" name="lang" value="en">
                            <button type="submit" class="btn btn-outline-secondary {% if lang == 'en' %}active{% endif %}">English</button>
                        </form>
                        <form method="get" style="display:inline;">
                            <input type="hidden" name="lang" value="hi">
                            <button type="submit" class="btn btn-outline-secondary {% if lang == 'hi' %}active{% endif %}">हिन्दी</button>
                        </form>
                        <form method="get" style="display:inline;">
                            <input type="hidden" name="lang" value="mr">
                            <button type="submit" class="btn btn-outline-secondary {% if lang == 'mr' %}active{% endif %}">मराठी</button>
                        </form>
                    </div>
                </div>
                <form method="post" class="needs-validation premium-form" novalidate autocomplete="off">
                    {% csrf_token %}
                    <div class="row g-4">
                        {% for field in form %}
                        <div class="col-12 form-floating mb-2">
                            {{ field }}
                            <label for="id_{{ field.name }}" class="fw-semibold">{{ field.label }}</label>
                            {% if field.errors %}
                                <div class="invalid-feedback d-block">{{ field.errors|striptags }}</div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                    <div class="d-grid mt-4">
                        <button type="submit" class="btn btn-lg btn-gradient fw-bold ripple"> <i class="bi bi-lightning-charge-fill me-2"></i>Recommend Crop</button>
                    </div>
                </form>
                <div class="mt-3 mb-3 text-center">
                    <!-- Language selection moved to its own section above -->
                </div>
                {% if result %}
                <div class="alert alert-success mt-4 text-center premium-result animate__animated animate__fadeInUp">
                    <i class="bi bi-patch-check-fill me-2"></i><h4 class="mb-0 d-inline">{{ result }}</h4>
                </div>
                {% endif %}
                {% if plan %}
                <div class="mt-5">
                    <h3 class="fw-bold text-gradient mb-3">
                        {% if lang == 'en' %}Weekly Planner for {{ result|slice:'18:' }}
                        {% elif lang == 'hi' %}{{ result|slice:'18:' }} के लिए साप्ताहिक योजना
                        {% elif lang == 'mr' %}{{ result|slice:'18:' }} साठी साप्ताहिक योजना
                        {% endif %}
                    </h3>
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover glass-card">
                            <thead class="table-success">
                                <tr>
                                    <th>
                                        {% if lang == 'en' %}Week
                                        {% elif lang == 'hi' %}सप्ताह
                                        {% elif lang == 'mr' %}आठवडा
                                        {% endif %}
                                    </th>
                                    <th>
                                        {% if lang == 'en' %}Icon
                                        {% elif lang == 'hi' %}चिह्न
                                        {% elif lang == 'mr' %}चिन्ह
                                        {% endif %}
                                    </th>
                                    <th>
                                        {% if lang == 'en' %}Task (Simple)
                                        {% elif lang == 'hi' %}कार्य
                                        {% elif lang == 'mr' %}काम
                                        {% endif %}
                                    </th>
                                    <th>
                                        {% if lang == 'en' %}Medicine
                                        {% elif lang == 'hi' %}दवा
                                        {% elif lang == 'mr' %}औषध
                                        {% endif %}
                                    </th>
                                    <th>
                                        {% if lang == 'en' %}Precaution
                                        {% elif lang == 'hi' %}सावधानी
                                        {% elif lang == 'mr' %}काळजी
                                        {% endif %}
                                    </th>
                                    <th>
                                        {% if lang == 'en' %}Tip
                                        {% elif lang == 'hi' %}सुझाव
                                        {% elif lang == 'mr' %}सूचना
                                        {% endif %}
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in plan %}
                                <tr>
                                    <td>{{ item.week }}</td>
                                    <td style="font-size:1.5rem;">{{ item.icon }}</td>
                                    <td>{{ item.task }}</td>
                                    <td>{{ item.medicine }}</td>
                                    <td>{{ item.precaution }}</td>
                                    <td>{{ item.tip }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_section %}
<section class="how-it-works-section py-5 mt-4">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <h3 class="fw-bold mb-3 text-gradient">How It Works</h3>
                <p class="lead mb-4">Enter your soil and weather parameters above. Our AI model analyzes your data and instantly recommends the most suitable crop for your conditions. This helps you make informed decisions and maximize your yield.</p>
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm glass-card p-3 h-100">
                            <div class="mb-2"><i class="bi bi-bar-chart-steps fs-2 text-gradient"></i></div>
                            <h5 class="fw-semibold">1. Input Data</h5>
                            <p class="small">Fill in the form with your soil nutrients, temperature, humidity, pH, and rainfall.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm glass-card p-3 h-100">
                            <div class="mb-2"><i class="bi bi-cpu fs-2 text-gradient"></i></div>
                            <h5 class="fw-semibold">2. AI Analysis</h5>
                            <p class="small">Our advanced AI model processes your data and predicts the best crop for your field.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm glass-card p-3 h-100">
                            <div class="mb-2"><i class="bi bi-emoji-smile fs-2 text-gradient"></i></div>
                            <h5 class="fw-semibold">3. Get Recommendation</h5>
                            <p class="small">See your personalized crop suggestion instantly and plan your farming with confidence!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
